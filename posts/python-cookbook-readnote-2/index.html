<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Python Cookbook 读书笔记（二） | Astropeak</title>
<style>
        @font-face {
            font-family: "libretto-icons";
            src:url(../../assets/fonts/libretto-icons.eot);
            src:url(../../assets/fonts/libretto-icons.eot#iefix) format("embedded-opentype"),
            url(../../assets/fonts/libretto-icons.woff) format("woff"),
            url(../../assets/fonts/libretto-icons.ttf) format("truetype"),
            url(../../assets/fonts/libretto-icons.svg#libretto-icons) format("svg");
            font-weight: normal;
            font-style: normal;
        }
    </style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Sans+Mono%7CLibre+Baskerville%7CMontserrat%7CPlayfair+Display">
<link rel="stylesheet" href="../../assets/css/libretto_styles.css">
<link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">
</head>
<body>
    <!-- Navigation bar -->
    <header class="nav-bar"><div class="site-branding">
            <h1 class="site-title">
                <a href="https://astropeak.github.io/" title="Astropeak" rel="home">Astropeak</a>
            </h1>
        </div>
        <nav class="site-navigation" role="navigation"><div class="menu-toggle">
                <span class="mobile-site-title">Astropeak</span>
            </div>
            <ul class="menu">
<li><a href="../../archive.html">Archive</a></li>
                    <li><a href="../../categories/">Tags</a></li>
                    <li><a href="../../rss.xml">RSS feed</a></li>
                    <li><a href="http://github.com/astropeak">Github</a></li>
            </ul></nav></header><!-- Page Header --><div class="title-block post-format-icon-pin">
        <div class="entry-meta">
            <span class="posted-on">
                Posted on <a href="." rel="bookmark">July 15, 2017</a>
            </span>
        </div>
        <h1>Python Cookbook 读书笔记（二）</h1>
    </div>

        <!-- Page Content -->
    <div class="site-content" role="main">
        <article class="format-standard libretto-long-form"><div class="entry-content">
                <p>
《<a href="http://shop.oreilly.com/product/0636920027072.do">Python Cookbook</a>》读书笔记.
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">chapter 2: Strings and Text</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">2.1. Splitting Strings on Any of Multiple Delimiters</h3>
<div class="outline-text-3" id="text-1-1">
<p>
By us re.split and the regexp is r'[,;\s]\s*'
</p>
</div>
<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">difference between str.split and re.split</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
str.split only accept simple seperator
re.split accept regulare expression.
</p>
</div>
</div>
<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">return value of re.split</h4>
<div class="outline-text-4" id="text-1-1-2">
<ol class="org-ol">
<li>if there are no capture group, then the same as str.split
</li>
<li>if there are capture group, then all matched data will also be returned.
then the value will be rst[::2], the seperator will be rst[1::2]
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"I, you; a  seperater.   haha"</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[,;.\s]\s*'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">'([,;.\s]\s*)'</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3">iterate on two lists, by first zip the two to one</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
looks nice!
</p>
<div class="highlight"><pre><span></span><span class="c1"># Reform the line using the same delimiters</span>
<span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="n">d</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">))</span>
<span class="s1">'asdf fjdk;afed,fjek,asdf,foo'</span>
</pre></div>
</div>
</div>


<div id="outline-container-sec-1-1-4" class="outline-4">
<h4 id="sec-1-1-4">regexp noncapture group, by r'(?:…)'</h4>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">2.2. Matching Text at the Start or End of a String, by str.startswith() or str.endswith() method</h3>
<div class="outline-text-3" id="text-1-2">
<div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">"aaaa.txt"</span>
<span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".txt"</span><span class="p">)</span>
<span class="c1"># pass a tuple to check against multiple choices</span>
<span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">".c"</span><span class="p">,</span> <span class="s2">".h"</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s1">'http:'</span><span class="p">,</span> <span class="s1">'https:'</span><span class="p">,</span> <span class="s1">'ftp:'</span><span class="p">)):</span>
	<span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>

<p>
The parameter is simple string.
</p>

<p>
Compared to re.match, str.startswith looks nice.
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">2.3. Matching Strings Using Shell Wildcard Patterns, with fnmatch.fnmatch(), fnmatch.fnmatchcase()</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Shell wildcard:
</p>
<ul class="org-ul">
<li>[] : a charset
</li>
<li>* : match any length of chars
</li>
<li>? : match only one char
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fnmatch</span> <span class="kn">import</span> <span class="n">fnmatch</span>
<span class="k">print</span><span class="p">(</span><span class="n">fnmatch</span><span class="p">(</span><span class="s2">"data 1.txt"</span><span class="p">,</span> <span class="s2">"*[0-9]*"</span><span class="p">))</span>
</pre></div>

<ol class="org-ol">
<li>the pattern must match the whole string
</li>
<li>compares to startswith(), fnmatch can match at any position
</li>
<li>compares to regexp, fnmatch looks nice
</li>
<li>fnmatch will use the same case-sensitive rule as the OS, fnmatchcase will always respect case.
</li>
<li>between simpe string and full power of regexp
</li>
</ol>
</div>
</div>


<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">2.4. Matching and Searching for Text Patterns</h3>
<div class="outline-text-3" id="text-1-4">
<p>
What's  the difference between matching and searching
</p>
</div>

<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">the str.find() function: find the start index of a substring</h4>
<div class="outline-text-4" id="text-1-4-1">
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"Hello xxx bbbb"</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"xx"</span><span class="p">))</span>
</pre></div>
</div>
</div>


<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2">re.compile() function: compile a regexp strinng to a regexp object, for performance</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
If you use the regexp many times, then first compile it is good. But if you only use it for one time, then don't use the compile function
</p>
</div>
</div>

<div id="outline-container-sec-1-4-3" class="outline-4">
<h4 id="sec-1-4-3">difference between r'\d' and '\d'</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
if the string is prefixed by  a 'r', then the '\' in the string will not be intepreted by the string parser.
So the second regexp is actually r'd'.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4" class="outline-4">
<h4 id="sec-1-4-4">re.findall() function, find all matched data as a list</h4>
<div class="outline-text-4" id="text-1-4-4">
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">rg</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'\d+/(?:\d+)/(?:\d+)'</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'Today'</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rg</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

<p>
The return value: if there are capture groups, then the return value is the captured data, and if the capture group number is one, it will be  a string, else be  a tuple of strings.
if  no capture groups, then the return value is all matched  data.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-5" class="outline-4">
<h4 id="sec-1-4-5">re.finditer(), find all matched data as a iterater</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
Seems the return value is different from re.findall(), it will return a  matched object , the same as re.match()
Seems strange, and highly inconsistent.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-6" class="outline-4">
<h4 id="sec-1-4-6">re.match() function, always match at the start of a string</h4>
</div>
<div id="outline-container-sec-1-4-7" class="outline-4">
<h4 id="sec-1-4-7">re.match() function, return value</h4>
<div class="outline-text-4" id="text-1-4-7">
<p>
rst.group(0): the matched data
rst.group(1): the first captured data
rst.groups(): all captured data as a tuple
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">2.5. Searching and Replacing Text</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1">the str.replace function, replace all occurence in a string</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
str.replcae(pattern, replacement)
</p>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'yeah, but no, but yeah, but no, but yeah'</span>
<span class="k">print</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'yeah'</span><span class="p">,</span> <span class="s1">'yep'</span><span class="p">))</span>
<span class="c1"># 'yep, but no, but yep, but no, but yep'</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-2" class="outline-4">
<h4 id="sec-1-5-2">the re.sub(pattern, replacement, text) function, will also replace all occurence in a string</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
use r'\1' to refer to the first captured group
</p>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'(\d+)/(\d+)/(\d+)'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'\3-\1-\2'</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
<span class="c1"># 'Today is 2012-11-27. PyCon starts 2013-3-13.'</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-3" class="outline-4">
<h4 id="sec-1-5-3">the re.sub(pattern, callback, text) function, will also replace all occurence in a string</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
The second parameter can also be a function, the parameter to this function is a match object(the  same returned by re.match function).
</p>

<p>
The same example as the above one:
</p>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">y</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">d</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'(\d+)/(\d+)/(\d+)'</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
</pre></div>
</div>
</div>


<div id="outline-container-sec-1-5-4" class="outline-4">
<h4 id="sec-1-5-4">the re.subn(…) function, same as re.sub, but also return subsitution counts also</h4>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">2.6. Searching and Replacing Case-Insensitive Text</h3>
<div class="outline-text-3" id="text-1-6">
<p>
To do case-insensitive operations, you must use regexp with the re.IGNORECASE flags keyword parameter
</p>
</div>

<div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1">replace words in a string with original case preserved</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
a excenlent example of replacing with 原始的大小写规则. 并且是一个很好的高阶函数的例子。
</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">matchcase</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
	<span class="n">text</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
	    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
	<span class="k">elif</span> <span class="n">text</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
	    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
	<span class="k">elif</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
	    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">word</span>

    <span class="k">return</span> <span class="n">replace</span>

<span class="n">text</span> <span class="o">=</span> <span class="s1">'UPPER PYTHON, lower python, Mixed Python'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">'python'</span><span class="p">,</span> <span class="n">matchcase</span><span class="p">(</span><span class="s1">'snake'</span><span class="p">),</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">))</span>
<span class="c1"># 'UPPER SNAKE, lower snake, Mixed Snake'</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">2.7. Specifying a Regular Expression(regexp) for the Shortest Match, by using modifier '?', no-greedy match</h3>
<div class="outline-text-3" id="text-1-7">
<p>
By default, * will match longest data. if appended with a '?' then it will match the shortest
</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">text1</span> <span class="o">=</span> <span class="s1">'Computer says "no."'</span>
<span class="n">r</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'"(.*)"'</span><span class="p">,</span> <span class="n">text1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">text2</span> <span class="o">=</span> <span class="s1">'Computer says "no." Phone says "yes."'</span>
<span class="n">r</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'"(.*)"'</span><span class="p">,</span> <span class="n">text2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Now add a '?' after '*', no greedy match</span>
<span class="n">r</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'"(.*?)"'</span><span class="p">,</span> <span class="n">text2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8">2.8. Writing a Regular Expression for Multiline Patterns</h3>
<div class="outline-text-3" id="text-1-8">
<p>
By default, '.' will not match a new line character. 
there are two choices to let '.' match a new line character:
</p>
<ol class="org-ol">
<li>by alternative.
change r'.*' to r'(?:.|\n)*'
</li>
<li>by use the re.DOTALL flag
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'''/* aaaa</span>
<span class="s1">bbbb</span>
<span class="s1">cccc */'''</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'/\*.*\*/'</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'/\*(?:.|\n)*\*/'</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</li>
</ol>
</div>

<div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1">the re.DOTALL flag: let '.' match a newline character</h4>
</div>
</div>
<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9">2.9. Normalizing Unicode Text to a Standard Representation, by unicodedata.normalize('NFC', str)</h3>
<div class="outline-text-3" id="text-1-9">
<p>
unicode may have more than one representation, see example in the book
</p>
</div>
<div id="outline-container-sec-1-9-1" class="outline-4">
<h4 id="sec-1-9-1">normalizing means make sth. has the uniform format/type</h4>
</div>
</div>
<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10">2.11. Stripping Unwanted Characters from Strings</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-sec-1-10-1" class="outline-4">
<h4 id="sec-1-10-1">str.strip() function. lstrip(), rstrip(), delete whitespaces characters at begining or ending</h4>
<div class="outline-text-4" id="text-1-10-1">
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"    a b c </span><span class="se">\n</span><span class="s2"> "</span><span class="p">;</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</pre></div>
<p>
<b>*</b> delete characters in middle of string, by str.replace(), or re.sub()
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"   hello     word    "</span><span class="p">;</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">""</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"\s+"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
</pre></div>
<p>
<b>*</b> create a generator object  by an expression, by '(' instead of '[', like lazy evaluation on other languages
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">import os.path</span>
<span class="s1">rst = ""</span>
<span class="s1">if os.path.isfile(""):</span>
<span class="s1">    with open("", "r") as f:</span>
<span class="s1">	rst = f.read()</span>
<span class="s1">'''</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ss</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">s1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11">2.12. Sanitizing and Cleaning Up Text</h3>
<div class="outline-text-3" id="text-1-11">
</div>
<div id="outline-container-sec-1-11-1" class="outline-4">
<h4 id="sec-1-11-1">str.translate() function, change characters given a table/dictionary, the book given much unicode examples</h4>
</div>
</div>

<div id="outline-container-sec-1-12" class="outline-3">
<h3 id="sec-1-12">2.13. Aligning Text Strings</h3>
<div class="outline-text-3" id="text-1-12">
</div>
<div id="outline-container-sec-1-12-1" class="outline-4">
<h4 id="sec-1-12-1">the str.ljust(), str.rjust(), str.center() functions</h4>
<div class="outline-text-4" id="text-1-12-1">
<p>
accept a number, and an optionall character
</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">"="</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-12-2" class="outline-4">
<h4 id="sec-1-12-2">the format function and the str.format methods</h4>
<div class="outline-text-4" id="text-1-12-2">
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="s2">"aaa"</span><span class="p">,</span> <span class="s2">"&gt;20"</span><span class="p">))</span> <span class="c1"># same as rjust</span>
<span class="k">print</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="s2">"aaa"</span><span class="p">,</span> <span class="s2">"=&lt;20"</span><span class="p">))</span> <span class="c1"># same as ljust</span>
<span class="k">print</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="s2">"aaa"</span><span class="p">,</span> <span class="s2">"^20"</span><span class="p">))</span> <span class="c1"># same as center</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"{} {:=^10}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
</pre></div>





<p>
"%s %s" % (a, b) is old way, now should use the new way.
</p>
</div>
</div>
</div>


<div id="outline-container-sec-1-13" class="outline-3">
<h3 id="sec-1-13">2.14. Combining and Concatenating Strings</h3>
<div class="outline-text-3" id="text-1-13">
</div>
<div id="outline-container-sec-1-13-1" class="outline-4">
<h4 id="sec-1-13-1">by str.join</h4>
</div>

<div id="outline-container-sec-1-13-2" class="outline-4">
<h4 id="sec-1-13-2">by + operator</h4>
</div>

<div id="outline-container-sec-1-13-3" class="outline-4">
<h4 id="sec-1-13-3">by print function's 'sep' parameter</h4>
</div>

<div id="outline-container-sec-1-13-4" class="outline-4">
<h4 id="sec-1-13-4">by format function</h4>
</div>
</div>
<div id="outline-container-sec-1-14" class="outline-3">
<h3 id="sec-1-14">2.15. Interpolating Variables in Strings, by str.format() or str.format<sub>map</sub>() method</h3>
<div class="outline-text-3" id="text-1-14">
<p>
Note: format<sub>map</sub> doesn't exist in python 2.7
</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"{name} is {age} years old"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Tom"</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">16</span><span class="p">))</span>

<span class="n">name</span> <span class="o">=</span> <span class="s2">"Jim"</span>
<span class="n">age</span> <span class="o">=</span> <span class="mi">18</span>
<span class="c1"># print("{name} is {age} years old".format_map(vars()))</span>
</pre></div>


<p>
format<sub>map</sub> accept a dictionay, while format accept keywords parameters
</p>
</div>
<div id="outline-container-sec-1-14-1" class="outline-4">
<h4 id="sec-1-14-1">the vars() function, the same as locals() if no parameter</h4>
<div class="outline-text-4" id="text-1-14-1">
<p>
if pass one parameter, then it is the same as obj._<sub>dict</sub>__
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'abc'</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">123</span>
<span class="k">print</span><span class="p">(</span><span class="nb">vars</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="c1"># print(vars(s))</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-14-2" class="outline-4">
<h4 id="sec-1-14-2">the dict._<sub>missing</sub>_<sub>(self, key)</sub> method will be called when a key not exists, then KeyError will not be raised.</h4>
<div class="outline-text-4" id="text-1-14-2">
<p>
If this method is defined, then when a key not exists, it will be called and return the value. Else a KeyError will be raised.
</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">safedict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
	<span class="k">return</span> <span class="s1">'{'</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s1">'}'</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">safedict</span><span class="p">();</span>
<span class="k">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">'name'</span><span class="p">])</span>
<span class="n">d1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">();</span>
<span class="c1"># print(d1['name'])</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-14-3" class="outline-4">
<h4 id="sec-1-14-3">a function that will do variable interpolating from env, just like $var in perl, by str.format<sub>map</sub>
</h4>
<div class="outline-text-4" id="text-1-14-3">
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">safedict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
	<span class="k">return</span> <span class="s1">'{'</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s1">'}'</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">safedict</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f_locals</span><span class="p">))</span>

<span class="n">name</span><span class="o">=</span><span class="s2">"Jim"</span>
<span class="n">age</span><span class="o">=</span><span class="mi">18</span>
<span class="k">print</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="s2">"{name} is {age} years old"</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'name'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'John'</span><span class="p">,</span> <span class="s1">'Peter'</span><span class="p">],</span>
   <span class="s1">'age'</span><span class="p">:</span> <span class="p">[</span><span class="mi">56</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'My name is {{name[{0}]}}, I am {{age[{0}]}} years old.'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">people</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-14-4" class="outline-4">
<h4 id="sec-1-14-4">sys.<sub>getframe</sub>([depth]): like calls in perl, get the stack frame</h4>
<div class="outline-text-4" id="text-1-14-4">
<p>
depth default to 0, means current stack frame. 
f<sub>locals</sub> attribute is used to get all local variabls.
f<sub>lineno</sub> attribute is the line number.
</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_globals</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-1-15" class="outline-3">
<h3 id="sec-1-15">2.16. Reformatting Text to a Fixed Number of Columns, by textwrap.fill(astr, columns, initial<sub>indent</sub>='', subsquent<sub>indent</sub>='')</h3>
<div class="outline-text-3" id="text-1-15">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textwrap</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">"Look into my eyes, look into my eyes, the eyes, the eyes, </span><span class="se">\</span>
<span class="s2">the eyes, not around the eyes, don't look around the eyes, </span><span class="se">\</span>
<span class="s2">look into my eyes, you're under."</span>

<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>

<div id="outline-container-sec-1-15-1" class="outline-4">
<h4 id="sec-1-15-1">get terminal column size, by os.get<sub>terminal</sub><sub>size</sub>().columns</h4>
<div class="outline-text-4" id="text-1-15-1">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">get_terminal_size</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-1-16" class="outline-3">
<h3 id="sec-1-16">2.17. Handling HTML and XML Entities in Text</h3>
<div class="outline-text-3" id="text-1-16">
</div>
<div id="outline-container-sec-1-16-1" class="outline-4">
<h4 id="sec-1-16-1">the html.escape(astr, quote=True) function:</h4>
<div class="outline-text-4" id="text-1-16-1">
<p>
escape means convert special characters to 
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'&lt;a&gt;this is &lt;/a&gt;'</span>
<span class="kn">import</span> <span class="nn">html</span>
<span class="k">print</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-16-2" class="outline-4">
<h4 id="sec-1-16-2">the str.encode('ascii', errors='xmlcharrefreplace') function: encode a string to ascii</h4>
<div class="outline-text-4" id="text-1-16-2">
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'Spicy Jalapeño'</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'ascii'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'xmlcharrefreplace'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
            </div>
        </article>
</div>

        <!-- Tag Section -->
    <div class="site-content navigation-post">
        <div class="tag-head">Tags</div>
        <div class="tag-list">
                <a href="../../categories/python/">python</a>
        </div>
    </div>

        <!-- Post Navigation links -->
<nav class="site-content navigation-post" role="navigation"><div class="previous">
            <a href="../python-cookbook-readnote-1/" rel="prev">
                <span class="meta-nav">Older Post</span>Python Cookbook 读书笔记（一）
            </a>
        </div>
        <div class="next">
            <a href="../python-cookbook-readnote-3/" rel="next">
                <span class="meta-nav">Newer Post</span>Python Cookbook 读书笔记（三）
            </a>
        </div>
</nav><!-- Page Footer --><section class="footer-sidebar clear" role="complementary"><div class="widget-block">
            <aside class="widget"><h2 class="widget-title">Astropeak</h2>
                <div class="widget-text">Astropeak's blogs.</div>
            </aside>
</div>
    </section><!-- Site Attributions --><footer class="site-footer" role="contentinfo"><div class="site-info">
            <p>Contents © 2018         <a href="mailto:astropeak@gmail.com">Astropeak</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
        </div>
        <div class="social">
            <ul class="menu"></ul>
</div>
    </footer>
</body>
</html>
