<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Astropeak (old posts, page 1)</title>
<style>
        @font-face {
            font-family: "libretto-icons";
            src:url(assets/fonts/libretto-icons.eot);
            src:url(assets/fonts/libretto-icons.eot#iefix) format("embedded-opentype"),
            url(assets/fonts/libretto-icons.woff) format("woff"),
            url(assets/fonts/libretto-icons.ttf) format("truetype"),
            url(assets/fonts/libretto-icons.svg#libretto-icons) format("svg");
            font-weight: normal;
            font-style: normal;
        }
    </style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Sans+Mono%7CLibre+Baskerville%7CMontserrat%7CPlayfair+Display">
<link rel="stylesheet" href="assets/css/libretto_styles.css">
<link href="assets/css/custom.css" rel="stylesheet" type="text/css">
</head>
<body>
    <!-- Navigation bar -->
    <header class="nav-bar"><div class="site-branding">
            <h1 class="site-title">
                <a href="https://astropeak.github.io/" title="Astropeak" rel="home">Astropeak</a>
            </h1>
        </div>
        <nav class="site-navigation" role="navigation"><div class="menu-toggle">
                <span class="mobile-site-title">Astropeak</span>
            </div>
            <ul class="menu">
<li><a href="archive.html">Archive</a></li>
                    <li><a href="categories/">Tags</a></li>
                    <li><a href="rss.xml">RSS feed</a></li>
                    <li><a href="http://github.com/astropeak">Github</a></li>
            </ul></nav></header><div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/python-cookbook-readnote-2/" rel="bookmark">July 15, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/python-cookbook-readnote-2/">Python Cookbook 读书笔记（二）</a></h1>
                </div>
                <div class="entry-content">
                        <p>
《<a href="http://shop.oreilly.com/product/0636920027072.do">Python Cookbook</a>》读书笔记.
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">chapter 2: Strings and Text</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">2.1. Splitting Strings on Any of Multiple Delimiters</h3>
<div class="outline-text-3" id="text-1-1">
<p>
By us re.split and the regexp is r'[,;\s]\s*'
</p>
</div>
<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">difference between str.split and re.split</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
str.split only accept simple seperator
re.split accept regulare expression.
</p>
</div>
</div>
<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">return value of re.split</h4>
<div class="outline-text-4" id="text-1-1-2">
<ol class="org-ol">
<li>if there are no capture group, then the same as str.split
</li>
<li>if there are capture group, then all matched data will also be returned.
then the value will be rst[::2], the seperator will be rst[1::2]
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"I, you; a  seperater.   haha"</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[,;.\s]\s*'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">'([,;.\s]\s*)'</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3">iterate on two lists, by first zip the two to one</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
looks nice!
</p>
<div class="highlight"><pre><span></span><span class="c1"># Reform the line using the same delimiters</span>
<span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="n">d</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">))</span>
<span class="s1">'asdf fjdk;afed,fjek,asdf,foo'</span>
</pre></div>
</div>
</div>


<div id="outline-container-sec-1-1-4" class="outline-4">
<h4 id="sec-1-1-4">regexp noncapture group, by r'(?:…)'</h4>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">2.2. Matching Text at the Start or End of a String, by str.startswith() or str.endswith() method</h3>
<div class="outline-text-3" id="text-1-2">
<div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">"aaaa.txt"</span>
<span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".txt"</span><span class="p">)</span>
<span class="c1"># pass a tuple to check against multiple choices</span>
<span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">".c"</span><span class="p">,</span> <span class="s2">".h"</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s1">'http:'</span><span class="p">,</span> <span class="s1">'https:'</span><span class="p">,</span> <span class="s1">'ftp:'</span><span class="p">)):</span>
	<span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>

<p>
The parameter is simple string.
</p>

<p>
Compared to re.match, str.startswith looks nice.
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">2.3. Matching Strings Using Shell Wildcard Patterns, with fnmatch.fnmatch(), fnmatch.fnmatchcase()</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Shell wildcard:
</p>
<ul class="org-ul">
<li>[] : a charset
</li>
<li>* : match any length of chars
</li>
<li>? : match only one char
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fnmatch</span> <span class="kn">import</span> <span class="n">fnmatch</span>
<span class="k">print</span><span class="p">(</span><span class="n">fnmatch</span><span class="p">(</span><span class="s2">"data 1.txt"</span><span class="p">,</span> <span class="s2">"*[0-9]*"</span><span class="p">))</span>
</pre></div>

<ol class="org-ol">
<li>the pattern must match the whole string
</li>
<li>compares to startswith(), fnmatch can match at any position
</li>
<li>compares to regexp, fnmatch looks nice
</li>
<li>fnmatch will use the same case-sensitive rule as the OS, fnmatchcase will always respect case.
</li>
<li>between simpe string and full power of regexp
</li>
</ol>
</div>
</div>


<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">2.4. Matching and Searching for Text Patterns</h3>
<div class="outline-text-3" id="text-1-4">
<p>
What's  the difference between matching and searching
</p>
</div>

<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">the str.find() function: find the start index of a substring</h4>
<div class="outline-text-4" id="text-1-4-1">
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"Hello xxx bbbb"</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"xx"</span><span class="p">))</span>
</pre></div>
</div>
</div>


<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2">re.compile() function: compile a regexp strinng to a regexp object, for performance</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
If you use the regexp many times, then first compile it is good. But if you only use it for one time, then don't use the compile function
</p>
</div>
</div>

<div id="outline-container-sec-1-4-3" class="outline-4">
<h4 id="sec-1-4-3">difference between r'\d' and '\d'</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
if the string is prefixed by  a 'r', then the '\' in the string will not be intepreted by the string parser.
So the second regexp is actually r'd'.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4" class="outline-4">
<h4 id="sec-1-4-4">re.findall() function, find all matched data as a list</h4>
<div class="outline-text-4" id="text-1-4-4">
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">rg</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'\d+/(?:\d+)/(?:\d+)'</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'Today'</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rg</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

<p>
The return value: if there are capture groups, then the return value is the captured data, and if the capture group number is one, it will be  a string, else be  a tuple of strings.
if  no capture groups, then the return value is all matched  data.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-5" class="outline-4">
<h4 id="sec-1-4-5">re.finditer(), find all matched data as a iterater</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
Seems the return value is different from re.findall(), it will return a  matched object , the same as re.match()
Seems strange, and highly inconsistent.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-6" class="outline-4">
<h4 id="sec-1-4-6">re.match() function, always match at the start of a string</h4>
</div>
<div id="outline-container-sec-1-4-7" class="outline-4">
<h4 id="sec-1-4-7">re.match() function, return value</h4>
<div class="outline-text-4" id="text-1-4-7">
<p>
rst.group(0): the matched data
rst.group(1): the first captured data
rst.groups(): all captured data as a tuple
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">2.5. Searching and Replacing Text</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1">the str.replace function, replace all occurence in a string</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
str.replcae(pattern, replacement)
</p>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'yeah, but no, but yeah, but no, but yeah'</span>
<span class="k">print</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'yeah'</span><span class="p">,</span> <span class="s1">'yep'</span><span class="p">))</span>
<span class="c1"># 'yep, but no, but yep, but no, but yep'</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-2" class="outline-4">
<h4 id="sec-1-5-2">the re.sub(pattern, replacement, text) function, will also replace all occurence in a string</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
use r'\1' to refer to the first captured group
</p>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'(\d+)/(\d+)/(\d+)'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'\3-\1-\2'</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
<span class="c1"># 'Today is 2012-11-27. PyCon starts 2013-3-13.'</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-3" class="outline-4">
<h4 id="sec-1-5-3">the re.sub(pattern, callback, text) function, will also replace all occurence in a string</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
The second parameter can also be a function, the parameter to this function is a match object(the  same returned by re.match function).
</p>

<p>
The same example as the above one:
</p>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">y</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">d</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'(\d+)/(\d+)/(\d+)'</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
</pre></div>
</div>
</div>


<div id="outline-container-sec-1-5-4" class="outline-4">
<h4 id="sec-1-5-4">the re.subn(…) function, same as re.sub, but also return subsitution counts also</h4>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">2.6. Searching and Replacing Case-Insensitive Text</h3>
<div class="outline-text-3" id="text-1-6">
<p>
To do case-insensitive operations, you must use regexp with the re.IGNORECASE flags keyword parameter
</p>
</div>

<div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1">replace words in a string with original case preserved</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
a excenlent example of replacing with 原始的大小写规则. 并且是一个很好的高阶函数的例子。
</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">matchcase</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
	<span class="n">text</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
	    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
	<span class="k">elif</span> <span class="n">text</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
	    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
	<span class="k">elif</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
	    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">word</span>

    <span class="k">return</span> <span class="n">replace</span>

<span class="n">text</span> <span class="o">=</span> <span class="s1">'UPPER PYTHON, lower python, Mixed Python'</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">'python'</span><span class="p">,</span> <span class="n">matchcase</span><span class="p">(</span><span class="s1">'snake'</span><span class="p">),</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">))</span>
<span class="c1"># 'UPPER SNAKE, lower snake, Mixed Snake'</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">2.7. Specifying a Regular Expression(regexp) for the Shortest Match, by using modifier '?', no-greedy match</h3>
<div class="outline-text-3" id="text-1-7">
<p>
By default, * will match longest data. if appended with a '?' then it will match the shortest
</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">text1</span> <span class="o">=</span> <span class="s1">'Computer says "no."'</span>
<span class="n">r</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'"(.*)"'</span><span class="p">,</span> <span class="n">text1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">text2</span> <span class="o">=</span> <span class="s1">'Computer says "no." Phone says "yes."'</span>
<span class="n">r</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'"(.*)"'</span><span class="p">,</span> <span class="n">text2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Now add a '?' after '*', no greedy match</span>
<span class="n">r</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'"(.*?)"'</span><span class="p">,</span> <span class="n">text2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8">2.8. Writing a Regular Expression for Multiline Patterns</h3>
<div class="outline-text-3" id="text-1-8">
<p>
By default, '.' will not match a new line character. 
there are two choices to let '.' match a new line character:
</p>
<ol class="org-ol">
<li>by alternative.
change r'.*' to r'(?:.|\n)*'
</li>
<li>by use the re.DOTALL flag
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'''/* aaaa</span>
<span class="s1">bbbb</span>
<span class="s1">cccc */'''</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'/\*.*\*/'</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'/\*(?:.|\n)*\*/'</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</li>
</ol>
</div>

<div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1">the re.DOTALL flag: let '.' match a newline character</h4>
</div>
</div>
<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9">2.9. Normalizing Unicode Text to a Standard Representation, by unicodedata.normalize('NFC', str)</h3>
<div class="outline-text-3" id="text-1-9">
<p>
unicode may have more than one representation, see example in the book
</p>
</div>
<div id="outline-container-sec-1-9-1" class="outline-4">
<h4 id="sec-1-9-1">normalizing means make sth. has the uniform format/type</h4>
</div>
</div>
<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10">2.11. Stripping Unwanted Characters from Strings</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-sec-1-10-1" class="outline-4">
<h4 id="sec-1-10-1">str.strip() function. lstrip(), rstrip(), delete whitespaces characters at begining or ending</h4>
<div class="outline-text-4" id="text-1-10-1">
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"    a b c </span><span class="se">\n</span><span class="s2"> "</span><span class="p">;</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</pre></div>
<p>
<b>*</b> delete characters in middle of string, by str.replace(), or re.sub()
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">"   hello     word    "</span><span class="p">;</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">""</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"\s+"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
</pre></div>
<p>
<b>*</b> create a generator object  by an expression, by '(' instead of '[', like lazy evaluation on other languages
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">import os.path</span>
<span class="s1">rst = ""</span>
<span class="s1">if os.path.isfile(""):</span>
<span class="s1">    with open("", "r") as f:</span>
<span class="s1">	rst = f.read()</span>
<span class="s1">'''</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ss</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">s1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11">2.12. Sanitizing and Cleaning Up Text</h3>
<div class="outline-text-3" id="text-1-11">
</div>
<div id="outline-container-sec-1-11-1" class="outline-4">
<h4 id="sec-1-11-1">str.translate() function, change characters given a table/dictionary, the book given much unicode examples</h4>
</div>
</div>

<div id="outline-container-sec-1-12" class="outline-3">
<h3 id="sec-1-12">2.13. Aligning Text Strings</h3>
<div class="outline-text-3" id="text-1-12">
</div>
<div id="outline-container-sec-1-12-1" class="outline-4">
<h4 id="sec-1-12-1">the str.ljust(), str.rjust(), str.center() functions</h4>
<div class="outline-text-4" id="text-1-12-1">
<p>
accept a number, and an optionall character
</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">"="</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"aaa"</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-12-2" class="outline-4">
<h4 id="sec-1-12-2">the format function and the str.format methods</h4>
<div class="outline-text-4" id="text-1-12-2">
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="s2">"aaa"</span><span class="p">,</span> <span class="s2">"&gt;20"</span><span class="p">))</span> <span class="c1"># same as rjust</span>
<span class="k">print</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="s2">"aaa"</span><span class="p">,</span> <span class="s2">"=&lt;20"</span><span class="p">))</span> <span class="c1"># same as ljust</span>
<span class="k">print</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="s2">"aaa"</span><span class="p">,</span> <span class="s2">"^20"</span><span class="p">))</span> <span class="c1"># same as center</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"{} {:=^10}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
</pre></div>





<p>
"%s %s" % (a, b) is old way, now should use the new way.
</p>
</div>
</div>
</div>


<div id="outline-container-sec-1-13" class="outline-3">
<h3 id="sec-1-13">2.14. Combining and Concatenating Strings</h3>
<div class="outline-text-3" id="text-1-13">
</div>
<div id="outline-container-sec-1-13-1" class="outline-4">
<h4 id="sec-1-13-1">by str.join</h4>
</div>

<div id="outline-container-sec-1-13-2" class="outline-4">
<h4 id="sec-1-13-2">by + operator</h4>
</div>

<div id="outline-container-sec-1-13-3" class="outline-4">
<h4 id="sec-1-13-3">by print function's 'sep' parameter</h4>
</div>

<div id="outline-container-sec-1-13-4" class="outline-4">
<h4 id="sec-1-13-4">by format function</h4>
</div>
</div>
<div id="outline-container-sec-1-14" class="outline-3">
<h3 id="sec-1-14">2.15. Interpolating Variables in Strings, by str.format() or str.format<sub>map</sub>() method</h3>
<div class="outline-text-3" id="text-1-14">
<p>
Note: format<sub>map</sub> doesn't exist in python 2.7
</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"{name} is {age} years old"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Tom"</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">16</span><span class="p">))</span>

<span class="n">name</span> <span class="o">=</span> <span class="s2">"Jim"</span>
<span class="n">age</span> <span class="o">=</span> <span class="mi">18</span>
<span class="c1"># print("{name} is {age} years old".format_map(vars()))</span>
</pre></div>


<p>
format<sub>map</sub> accept a dictionay, while format accept keywords parameters
</p>
</div>
<div id="outline-container-sec-1-14-1" class="outline-4">
<h4 id="sec-1-14-1">the vars() function, the same as locals() if no parameter</h4>
<div class="outline-text-4" id="text-1-14-1">
<p>
if pass one parameter, then it is the same as obj._<sub>dict</sub>__
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'abc'</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">123</span>
<span class="k">print</span><span class="p">(</span><span class="nb">vars</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="c1"># print(vars(s))</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-14-2" class="outline-4">
<h4 id="sec-1-14-2">the dict._<sub>missing</sub>_<sub>(self, key)</sub> method will be called when a key not exists, then KeyError will not be raised.</h4>
<div class="outline-text-4" id="text-1-14-2">
<p>
If this method is defined, then when a key not exists, it will be called and return the value. Else a KeyError will be raised.
</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">safedict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
	<span class="k">return</span> <span class="s1">'{'</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s1">'}'</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">safedict</span><span class="p">();</span>
<span class="k">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">'name'</span><span class="p">])</span>
<span class="n">d1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">();</span>
<span class="c1"># print(d1['name'])</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-14-3" class="outline-4">
<h4 id="sec-1-14-3">a function that will do variable interpolating from env, just like $var in perl, by str.format<sub>map</sub>
</h4>
<div class="outline-text-4" id="text-1-14-3">
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">safedict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
	<span class="k">return</span> <span class="s1">'{'</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s1">'}'</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">safedict</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f_locals</span><span class="p">))</span>

<span class="n">name</span><span class="o">=</span><span class="s2">"Jim"</span>
<span class="n">age</span><span class="o">=</span><span class="mi">18</span>
<span class="k">print</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="s2">"{name} is {age} years old"</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'name'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'John'</span><span class="p">,</span> <span class="s1">'Peter'</span><span class="p">],</span>
   <span class="s1">'age'</span><span class="p">:</span> <span class="p">[</span><span class="mi">56</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'My name is {{name[{0}]}}, I am {{age[{0}]}} years old.'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">people</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-14-4" class="outline-4">
<h4 id="sec-1-14-4">sys.<sub>getframe</sub>([depth]): like calls in perl, get the stack frame</h4>
<div class="outline-text-4" id="text-1-14-4">
<p>
depth default to 0, means current stack frame. 
f<sub>locals</sub> attribute is used to get all local variabls.
f<sub>lineno</sub> attribute is the line number.
</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_globals</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-1-15" class="outline-3">
<h3 id="sec-1-15">2.16. Reformatting Text to a Fixed Number of Columns, by textwrap.fill(astr, columns, initial<sub>indent</sub>='', subsquent<sub>indent</sub>='')</h3>
<div class="outline-text-3" id="text-1-15">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textwrap</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">"Look into my eyes, look into my eyes, the eyes, the eyes, </span><span class="se">\</span>
<span class="s2">the eyes, not around the eyes, don't look around the eyes, </span><span class="se">\</span>
<span class="s2">look into my eyes, you're under."</span>

<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>

<div id="outline-container-sec-1-15-1" class="outline-4">
<h4 id="sec-1-15-1">get terminal column size, by os.get<sub>terminal</sub><sub>size</sub>().columns</h4>
<div class="outline-text-4" id="text-1-15-1">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">get_terminal_size</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-1-16" class="outline-3">
<h3 id="sec-1-16">2.17. Handling HTML and XML Entities in Text</h3>
<div class="outline-text-3" id="text-1-16">
</div>
<div id="outline-container-sec-1-16-1" class="outline-4">
<h4 id="sec-1-16-1">the html.escape(astr, quote=True) function:</h4>
<div class="outline-text-4" id="text-1-16-1">
<p>
escape means convert special characters to 
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'&lt;a&gt;this is &lt;/a&gt;'</span>
<span class="kn">import</span> <span class="nn">html</span>
<span class="k">print</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-16-2" class="outline-4">
<h4 id="sec-1-16-2">the str.encode('ascii', errors='xmlcharrefreplace') function: encode a string to ascii</h4>
<div class="outline-text-4" id="text-1-16-2">
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'Spicy Jalapeño'</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'ascii'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'xmlcharrefreplace'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/python-cookbook-readnote-1/" rel="bookmark">July 10, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/python-cookbook-readnote-1/">Python Cookbook 读书笔记（一）</a></h1>
                </div>
                <div class="entry-content">
                        <p>
《<a href="http://shop.oreilly.com/product/0636920027072.do">Python Cookbook</a>》读书笔记.
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">chapter 1: Data Structures and Algorithms</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">1.6 Mapping Keys to Multiple Values in a Dictionary, by list value and defaultdict</h3>
<div class="outline-text-3" id="text-1-1">
<p>
example: create a dictionary with default value, by defaultdict
</p>

<p>
dictionary's property:
</p>
<ol class="org-ol">
<li>you can add new key to a dictionary
</li>
<li>but when you access a key that not exists, there will be error
</li>
<li>defaultdict is used to fix such problem.
</li>
</ol>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="sb">`dict`</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="sb">`func list`</span><span class="p">)</span>
<span class="c1"># `dict`['aaa'].append(2)</span>
<span class="err">$</span><span class="mi">0</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">1.6 example</h3>
<div class="outline-text-3" id="text-1-2">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">frequency</span><span class="p">[</span><span class="s1">'colorless'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">frequency</span><span class="p">[</span><span class="s1">'ideas'</span><span class="p">]</span> <span class="c1"># will be 0</span>

<span class="n">frequency</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="c1"># first, frequency['colorless'] will return a empty list, then append one element to this list.</span>
<span class="n">frequency</span><span class="p">[</span><span class="s1">'colorless'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">frequency</span><span class="p">[</span><span class="s1">'ideas'</span><span class="p">]</span> <span class="c1"># will be []</span>

<span class="c1"># Or you can pass a function take no arguments </span>

<span class="c1"># the idiom:</span>
<span class="n">my_dictionary</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">function</span> <span class="n">to</span> <span class="n">create</span> <span class="n">default</span> <span class="n">value</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
<span class="n">my_dictionary</span><span class="p">[</span><span class="n">item_key</span><span class="p">]</span> <span class="ow">is</span> <span class="n">updated</span> <span class="k">with</span> <span class="n">information</span> <span class="n">about</span> <span class="n">item</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">1.7 Keeping Dictionaries in Order, OrderedDict</h3>
<div class="outline-text-3" id="text-1-3">
<div class="highlight"><pre><span></span><span class="n">form</span> <span class="n">collections</span> <span class="kn">import</span> <span class="nn">OrderedDict</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="c1"># the insertion order will be reserved.</span>
</pre></div>

<p>
An typical application is when for serilization.
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">1.8. Calculating with Dictionaries</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">get max key/value in a dictionary, based on the value, by inverting the dict</h4>
<div class="outline-text-4" id="text-1-4-1">
<div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="sb">`dict`</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="sb">`dict`</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="c1"># another solution</span>
<span class="c1"># max(`dict`, key=lambda k:`dict`[k])</span>
</pre></div>
<p>
first convert the dict to list of (value, key) pairs, then max function will first compare value, then compare key.
</p>
</div>
</div>
<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2">result of the max value for many  things</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
for tuple and list, it just the element.
but for a dict, it returns only the key. Why? Because it accept a iterable as first parameter, and for a dictionary, the iterable value is the key.
</p>
</div>
</div>
<div id="outline-container-sec-1-4-3" class="outline-4">
<h4 id="sec-1-4-3">understanding of multi value bind</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
---&gt;  (b11, b12) = 1
TypeError: 'int' object is not iterable
</p>

<p>
The right hand side should be an iterable, every element in the iterable will be asigned to the left hand side variable, with each variable comsume one element exzactly. If the number of elements and variables not match, then there will be an error.
</p>

<p>
To consume more than one values, use the '*varname' expresstion, then the variable 'varname' will be a list of many elements.
</p>

<p>
Back to the error prints in the example, the 'int' object refers to the right side '1'.
</p>

<p>
PS:
I find python much simpler and funny than java.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">1.9. Finding Commonalities in Two Dictionaries</h3>
<div class="outline-text-3" id="text-1-5">
<p>
a dictionary's d.keys() and d.items() support set operations
So to find the common part keys/items in two dictionaries, just use the set operation '|' or 'union' function.
</p>
</div>
<div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1">get all keys as a iterable in a dictionary, by keys()</h4>
<div class="outline-text-4" id="text-1-5-1">
<div class="highlight"><pre><span></span><span class="sb">`dict`</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-2" class="outline-4">
<h4 id="sec-1-5-2">get all values as a iterable in a dictionary, by values()</h4>
<div class="outline-text-4" id="text-1-5-2">
<div class="highlight"><pre><span></span><span class="sb">`dict`</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-3" class="outline-4">
<h4 id="sec-1-5-3">get all key, value pairs as a iterable in a dictionary, by items()</h4>
<div class="outline-text-4" id="text-1-5-3">
<div class="highlight"><pre><span></span><span class="sb">`dict`</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5-4" class="outline-4">
<h4 id="sec-1-5-4">set operations</h4>
<div class="outline-text-4" id="text-1-5-4">
<p>
'|': union
'&amp;': intersection
'-': difference
's1 &lt; s2': check if s1 is a subset of s2
</p>

<p>
Example:
In <sup><a id="fnr.1" name="fnr.1" class="footref" href="posts/python-cookbook-readnote-1/#fn.1">1</a></sup>: e.keys(), d.keys()
Out<sup><a id="fnr.1.100" name="fnr.1.100" class="footref" href="posts/python-cookbook-readnote-1/#fn.1">1</a></sup>: (dict_keys([1, 4, 'a', 9]), dict_keys([1, 3, 5]))
</p>

<p>
In <sup><a id="fnr.2" name="fnr.2" class="footref" href="posts/python-cookbook-readnote-1/#fn.2">2</a></sup>: e.keys() &amp; d.keys()
Out<sup><a id="fnr.2.100" name="fnr.2.100" class="footref" href="posts/python-cookbook-readnote-1/#fn.2">2</a></sup>: {1}
</p>

<p>
In <sup><a id="fnr.3" name="fnr.3" class="footref" href="posts/python-cookbook-readnote-1/#fn.3">3</a></sup>: e.keys() | d.keys()
Out<sup><a id="fnr.3.100" name="fnr.3.100" class="footref" href="posts/python-cookbook-readnote-1/#fn.3">3</a></sup>: {1, 3, 4, 5, 'a', 9}
</p>

<p>
In <sup><a id="fnr.4" name="fnr.4" class="footref" href="posts/python-cookbook-readnote-1/#fn.4">4</a></sup>: e.keys() - d.keys()
Out<sup><a id="fnr.4.100" name="fnr.4.100" class="footref" href="posts/python-cookbook-readnote-1/#fn.4">4</a></sup>: {9, 4, 'a'}
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">1.10. Removing Duplicates from a Sequence while Maintaining Order</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1">problem: what is hashable(and the link to python glossary)</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
From the python glossary: 
<a href="https://docs.python.org/3/glossary.html">https://docs.python.org/3/glossary.html</a>
</p>

<p>
An object is hashable if it has a hash value which never changes during its lifetime (it needs a __hash__() method), and can be compared to other objects (it needs an __eq__() or __cmp__() method). Hashable objects which compare equal must have the same hash value.
</p>

<p>
Hashability makes an object usable as a dictionary key and a set member, because these data structures use the hash value internally.
</p>

<p>
All of Python’s immutable built-in objects are hashable, while no mutable containers (such as lists or dictionaries) are. Objects which are instances of user-defined classes are hashable by default; they all compare unequal, and their hash value is their id().
</p>
</div>
</div>
<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2">how yield/generator iterator is implemented</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
From the glossary, it works by suspends the function and  return the value, and save the current status. Then if it was called  next time, it will start execute from the place last time it was suspended. Great!! I understanded this.
</p>

<p>
generator
A function which returns a generator iterator. It looks like a normal function except that it contains yield expressions for producing a series of values usable in a for-loop or that can be retrieved one at a time with the next() function.
Usually refers to a generator function, but may refer to a generator iterator in some contexts. In cases where the intended meaning isn’t clear, using the full terms avoids ambiguity.
</p>

<p>
generator iterator
An object created by a generator function.
Each yield temporarily suspends processing, remembering the location execution state (including local variables and pending try-statements). When the generator iterator resumes, it picks-up where it left-off (in contrast to functions which start fresh on every invocation).
</p>
</div>
</div>

<div id="outline-container-sec-1-6-3" class="outline-4">
<h4 id="sec-1-6-3">file object is also an iterable, the element is a line</h4>
<div class="outline-text-4" id="text-1-6-3">
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">somefile</span><span class="p">,</span><span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-6-4" class="outline-4">
<h4 id="sec-1-6-4">a function that delete all duplicates in a list, with order preserved</h4>
<div class="outline-text-4" id="text-1-6-4">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dedupe</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
	<span class="n">val</span> <span class="o">=</span> <span class="n">item</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">key</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
	    <span class="k">yield</span> <span class="n">item</span>
	    <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</pre></div>
<p>
If the element is hashable, then key function is not needed. Else, provide a fucntion to convert the  element to a hashable element.
</p>

<p>
examples:
&gt;&gt;&gt; a = [ {'x':1, 'y':2}, {'x':1, 'y':3}, {'x':1, 'y':2}, {'x':2, 'y':4}]
&gt;&gt;&gt; list(dedupe(a, key=lambda d: (d['x'],d['y'])))
[{'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 2, 'y': 4}]
&gt;&gt;&gt; list(dedupe(a, key=lambda d: d['x']))
[{'x': 1, 'y': 2}, {'x': 2, 'y': 4}]
&gt;&gt;&gt;
</p>
</div>
</div>

<div id="outline-container-sec-1-6-5" class="outline-4">
<h4 id="sec-1-6-5">delete all duplicates in a list, don't preserve order, by set</h4>
<div class="outline-text-4" id="text-1-6-5">
<div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="sb">`list`</span><span class="p">)</span>
</pre></div>
<p>
Then all duplicate elements in list will be removed.
</p>
</div>
</div>

<div id="outline-container-sec-1-6-6" class="outline-4">
<h4 id="sec-1-6-6">the a?b:c expression in python, if else in one line</h4>
<div class="outline-text-4" id="text-1-6-6">
<div class="highlight"><pre><span></span><span class="n">val</span> <span class="o">=</span> <span class="n">b</span> <span class="k">if</span> <span class="n">a</span> <span class="k">else</span> <span class="n">c</span>
</pre></div>
<p>
looks good
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">1.11. Naming a Slice</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1">the slice object</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
create a  slice
</p>
<div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
<p>
'1:2' is just a shortcut to 'slice(1,2)'
</p>

<p>
slice attributes
</p>
<div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8">1.12. Determining the Most Frequently Occurring Items in a Sequence</h3>
<div class="outline-text-3" id="text-1-8">
<p>
A method by me
</p>
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># b = [d[k]+=1 for k in a]  # syntax error here</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
    <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">r</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>


<div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1">the collections.Counter class: change a list to a list of tuple of (element, count)</h4>
<div class="outline-text-4" id="text-1-8-1">
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># get the count</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># 3 is the element in a</span>


<span class="c1"># update with more words</span>
<span class="n">b</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="c1"># and a Counter object support the math operations: '+' and '-'</span>
</pre></div>

<p>
When you need to count data, use Counter class. This is a so little class, in practice, I will always write it from scratch before.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9">1.13. Sorting a List of Dictionaries by a Common Key</h3>
<div class="outline-text-3" id="text-1-9">
</div>
<div id="outline-container-sec-1-9-1" class="outline-4">
<h4 id="sec-1-9-1">the operator.itemgetter function</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
it will return a callable that can be passed to 'sorted':s key  parameter, for list  or dictionary
</p>
<div class="highlight"><pre><span></span><span class="c1"># return value of</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span>
<span class="c1"># is the same as this one</span>
<span class="k">lambda</span> <span class="n">r</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span>
<span class="c1"># but the former  is a little faster</span>
</pre></div>

<p>
仍然是非常小的功能，为什么搞得这么精细呢？
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10">1.14. Sorting Objects Without Native Comparison Support</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-sec-1-10-1" class="outline-4">
<h4 id="sec-1-10-1">the operator.attrgetter function</h4>
<div class="outline-text-4" id="text-1-10-1">
<p>
it will return a callable that can be passed to 'sorted':s key  parameter, for user defined class
</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="k">return</span> <span class="s1">'User({})'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># return value of</span>
<span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span>
<span class="c1"># is the same as this one</span>
<span class="k">lambda</span> <span class="n">o</span><span class="p">:</span><span class="n">o</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># but the former  is a little faster</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11">1.15. Grouping Records(a sequence of dictionaries) Together Based on a Field</h3>
<div class="outline-text-3" id="text-1-11">
</div>
<div id="outline-container-sec-1-11-1" class="outline-4">
<h4 id="sec-1-11-1">the itertools.groupby function: group sequencially the list as tuple (key, items)</h4>
<div class="outline-text-4" id="text-1-11-1">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">rows</span> <span class="o">=</span>  <span class="p">[{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>  <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">}]</span>
<span class="c1"># a should be a generator</span>
<span class="n">rows</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

<p>
another way is just use a default list dictionary to group, then no sort is needed.
</p>
</div>
</div>
</div>






<div id="outline-container-sec-1-12" class="outline-3">
<h3 id="sec-1-12">1.16. Filtering Sequence Elements</h3>
<div class="outline-text-3" id="text-1-12">
<p>
To fitering, just use list comprehension with an if condition
</p>
</div>
<div id="outline-container-sec-1-12-1" class="outline-4">
<h4 id="sec-1-12-1">itertools.compress function, a filtering tool</h4>
<div class="outline-text-4" id="text-1-12-1">
<p>
it takse two parameters:
</p>
<ol class="org-ol">
<li>an iterable which to be compressed
</li>
<li>a Boolean sequence, with the same length of first parameter
if the element in this sequence  is True, then the element at the same position in the first iterable will be put to the output

<p>
An example:
</p>
</li>
</ol>
<div class="highlight"><pre><span></span><span class="n">addresses</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'5412 N CLARK'</span><span class="p">,</span>
    <span class="s1">'5148 N CLARK'</span><span class="p">,</span>
    <span class="s1">'5800 E 58TH'</span><span class="p">,</span>
    <span class="s1">'2122 N CLARK'</span>
    <span class="s1">'5645 N RAVENSWOOD'</span><span class="p">,</span>
    <span class="s1">'1060 W ADDISON'</span><span class="p">,</span>
    <span class="s1">'4801 N BROADWAY'</span><span class="p">,</span>
    <span class="s1">'1039 W GRANVILLE'</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="c1"># Now a will be all items where count larger than 5</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>



<div id="outline-container-sec-1-13" class="outline-3">
<h3 id="sec-1-13">1.17. Extracting a Subset of a Dictionary</h3>
<div class="outline-text-3" id="text-1-13">
</div>
<div id="outline-container-sec-1-13-1" class="outline-4">
<h4 id="sec-1-13-1">dictionary comprehension, just like list comprehension, but use '{' instead of '['</h4>
<div class="outline-text-4" id="text-1-13-1">
<div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'ACME'</span><span class="p">:</span> <span class="mf">45.23</span><span class="p">,</span>
    <span class="s1">'AAPL'</span><span class="p">:</span> <span class="mf">612.78</span><span class="p">,</span>
    <span class="s1">'IBM'</span><span class="p">:</span> <span class="mf">205.55</span><span class="p">,</span>
    <span class="s1">'HPQ'</span><span class="p">:</span> <span class="mf">37.20</span><span class="p">,</span>
    <span class="s1">'FB'</span><span class="p">:</span> <span class="mf">10.75</span>
<span class="p">}</span>
<span class="c1"># Make a dictionary of all prices over 200</span>
<span class="n">p1</span> <span class="o">=</span> <span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">prices</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">200</span> <span class="p">}</span>
<span class="c1"># Make a dictionary of tech stocks</span>
<span class="n">tech_names</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'AAPL'</span><span class="p">,</span> <span class="s1">'IBM'</span><span class="p">,</span> <span class="s1">'HPQ'</span><span class="p">,</span> <span class="s1">'MSFT'</span> <span class="p">}</span>
<span class="n">p2</span> <span class="o">=</span> <span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">prices</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">tech_names</span> <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-sec-1-14" class="outline-3">
<h3 id="sec-1-14">1.18. Mapping Names to Sequence Elements</h3>
<div class="outline-text-3" id="text-1-14">
</div>
<div id="outline-container-sec-1-14-1" class="outline-4">
<h4 id="sec-1-14-1">the collections.nametuple function, map an index to a name, and access to an element with that name</h4>
<div class="outline-text-4" id="text-1-14-1">
<p>
example:
</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="n">People</span> <span class="o">=</span>  <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'People'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'age'</span><span class="p">])</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">People</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Jim'</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
</pre></div>

<p>
A good application:
for database selection.
</p>

<p>
The ._replace method:
Because a tuple is immutable, so to change an element, you can use _replace to  replace a field and a new one will be returned.
A tipical usage is first  create a prototype element with all field value be the default one, then update some fields with the _replace function.
Why there is a '_' in the function name?
</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="n">Stock</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Stock'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'shares'</span><span class="p">,</span> <span class="s1">'price'</span><span class="p">,</span> <span class="s1">'date'</span><span class="p">,</span> <span class="s1">'time'</span><span class="p">])</span>
<span class="c1"># Create a prototype instance</span>
<span class="n">stock_prototype</span> <span class="o">=</span> <span class="n">Stock</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="c1"># Function to convert a dictionary to a Stock</span>
<span class="k">def</span> <span class="nf">dict_to_stock</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">stock_prototype</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="o">**</span><span class="n">s</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'ACME'</span><span class="p">,</span> <span class="s1">'shares'</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'price'</span><span class="p">:</span> <span class="mf">123.45</span><span class="p">}</span>
<span class="n">dict_to_stock</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="c1"># Stock(name='ACME', shares=100, price=123.45, date=None, time=None)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-15" class="outline-3">
<h3 id="sec-1-15">1.19. Transforming and Reducing Data at the Same Time</h3>
<div class="outline-text-3" id="text-1-15">
<p>
use generator-expression argument
</p>

<p>
The reducing function means: given a list, return a value.
</p>
</div>
</div>
<div id="outline-container-sec-1-16" class="outline-3">
<h3 id="sec-1-16">the any function, check if any of an element is True in a iterable</h3>
<div class="outline-text-3" id="text-1-16">
</div>
<div id="outline-container-sec-1-16-1" class="outline-4">
<h4 id="sec-1-16-1">check if  any .py files exist in a directory</h4>
<div class="outline-text-4" id="text-1-16-1">
<div class="highlight"><pre><span></span><span class="c1"># Determine if any .py files exist in a directory</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'dirname'</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.py'</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'There be python!'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'Sorry, no python.'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-16-2" class="outline-4">
<h4 id="sec-1-16-2">get all files in a directory as a list</h4>
<div class="outline-text-4" id="text-1-16-2">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'dirname'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-16-3" class="outline-4">
<h4 id="sec-1-16-3">change a tuple/list/iterable to a csv line</h4>
<div class="outline-text-4" id="text-1-16-3">
<p>
This is much better than the string format method
</p>
<div class="highlight"><pre><span></span><span class="c1"># Output a tuple as CSV</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'ACME'</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">123.45</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">))</span><span class="c1"># Output a tuple as CSV</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-17" class="outline-3">
<h3 id="sec-1-17">1.20. Combining Multiple Mappings into a Single Mapping</h3>
<div class="outline-text-3" id="text-1-17">
</div>
<div id="outline-container-sec-1-17-1" class="outline-4">
<h4 id="sec-1-17-1">the collections.ChainMap</h4>
<div class="outline-text-4" id="text-1-17-1">
<p>
combining many maps/dictionaries, then when get an element, it will try to get from the first map, then the second, ...
</p>

<p>
And for operations that mutate the mapping always affect the first map/dictionary.
</p>

<p>
typical application:
scoped variable in a programming language.
</p>

<p>
Difference from the dict.update function:
ChainMap use a link to the original dictionary, while dict.update create a new one.
</p>
</div>
<ul class="org-ul"><li>
<a id="sec-1-17-1-1" name="sec-1-17-1-1"></a>check if an element exists in many dictionaries/maps, sequencially<br><div class="outline-text-5" id="text-1-17-1-1">
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'x'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">:</span> <span class="mi">3</span> <span class="p">}</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'y'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">:</span> <span class="mi">4</span> <span class="p">}</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">ChainMap</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">'x'</span><span class="p">])</span> <span class="c1"># Outputs 1 (from a)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">'y'</span><span class="p">])</span> <span class="c1"># Outputs 2 (from b)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">'z'</span><span class="p">])</span> <span class="c1"># Outputs 3 (from a)</span>
</pre></div>
</div>
</li></ul>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef">
<sup><a id="fn.1" name="fn.1" class="footnum" href="posts/python-cookbook-readnote-1/#fnr.1">1</a></sup><p>DEFINITION NOT FOUND.</p>
</div>

<div class="footdef">
<sup><a id="fn.2" name="fn.2" class="footnum" href="posts/python-cookbook-readnote-1/#fnr.2">2</a></sup><p>DEFINITION NOT FOUND.</p>
</div>

<div class="footdef">
<sup><a id="fn.3" name="fn.3" class="footnum" href="posts/python-cookbook-readnote-1/#fnr.3">3</a></sup><p>DEFINITION NOT FOUND.</p>
</div>

<div class="footdef">
<sup><a id="fn.4" name="fn.4" class="footnum" href="posts/python-cookbook-readnote-1/#fnr.4">4</a></sup><p>DEFINITION NOT FOUND.</p>
</div>


</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/hmm-word-segmentation/" rel="bookmark">May 6, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/hmm-word-segmentation/">基于隐马尔科夫模型的中文分词方法</a></h1>
                </div>
                <div class="entry-content">
                        <p>
本文主要讲述隐马尔科夫模及其在中文分词中的应用。 基于中文分词语料库，建立中文分词的隐马尔科夫模型，最后用维特比方法进行求解。
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">一、隐马尔科夫模型介绍</h2>
<div class="outline-text-2" id="text-1">
<p>
隐马尔科夫模型中包括两个序列，其中一个是观测序列，另一个是隐藏序列。模型要解决的一个问题是，给定观测序列，
求其对应的隐藏序列。比如对于语音识别，这里的观测序列是语音的每一个序列，隐藏序列是这一串语音对应的文字。
或者对于机器翻译，观测序列是待翻译的语言，而隐藏序列则是目标语言。在解决这类问题时，我们的已知条件是，
第一，隐藏序列中某一个元素到观测序列中某一个元素之间的映射关系。第二是隐藏序列中每个元素转变到另一个元素之间的关系。
并且会有两个假设，第一是每个隐藏元素中的元素，只依赖于它前面一个元素。第二是每一个隐藏元素能够直接确定另一个观测元素。
其中以上两个已知条件可以分别表示为两个矩阵，这个矩阵可以通过分词语料库，根据统计的方法求得。
</p>


<p>
从数学上理解，给定观测序列求解隐藏序列。一个观测序列可能对应无数个隐藏序列，而我们的目标隐藏序列就是，
概率最大的那一个隐藏序列，也就是说最有可能的那个序列。即求给定隐藏序列这个条件下观测序列概率最大的那个序列的条件概率问题。
</p>

<p>
虽然隐马尔科夫模型中做了比较强的假设，这里比较强的意思是，现实生活中，可能根本无法满足这种假设条件，
但是它的应用范围却是比较广泛，能够非常简单有效的解决复杂的问题。这个也是统计学方法的一个特点, 
基于大量的数据，使用简单的方法便可以解决复杂的问题。这可能是大数据的一种威力吧，如果我们有足够多的数据，
那么我们的模型可以做简化。而如果我们只有少量的数据，则我们必须用非常精确的模型，才可以得到我们想要的结果。
数据模型以及数据量也是一种此消彼长的关系。
</p>

<p>
下图为隐马尔科夫模型的概率图，其中 \(x\) 代表隐藏序列， \(y\) 代表观察序列。
<img src="posts/hmm-word-segmentation/img/hmm.png" alt="hmm.png"></p>

<p>
其中这里的隐藏序列，又称为一个马尔科夫链。马尔科夫链的定义是，序列中每一个元素，只依赖于他前面的一个元素而与其他所有元素不相关。
</p>


<p>
为了使用隐马尔科夫模型，我们必须知道两个矩阵。第一个矩阵式表示隐藏序列中, 一个元素转变到另一个元素的概率.
如果总的序列的元素数目为n，则这个是一个n乘n的矩阵。 
第二个矩阵表示隐藏序列中某个元素转变到观测序列中某个元素的概率. 如果隐藏序列中元素个数为n，观测序列中元素的数目为m，
则这个矩阵的维数为n乘m。 这两个矩阵都可以通过大量的统计数据来求得。
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">第二、中文分词的隐马尔科夫模型</h2>
<div class="outline-text-2" id="text-2">
<p>
中文分词要解决的问题是，给定一段中文文字，将其划分为一个个单独的词或者单字。中文分词是所有后续自然语言处理的基础。
如果将连续的中文文字看作是观测序列，将每个文字所对应的分词状态看作是隐藏序列，每个字的分子状态可能有两个值，
一个表示这个字是某一个词的词尾，用字母E表示。另一个表示这个字不是某一个词的词尾，用字母B表示。
则中文分词问题可以看作是一个标准的隐马尔科夫模型。实际中将每个字的分子状态表示为四个可选的值。
词的开始，词的中间，词的结尾，单字成词。分别用bmes表示。
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">第三、中文分词语料库</h2>
<div class="outline-text-2" id="text-3">
<p>
在网上可以免费下载，北京大学和香港大学提供的中文分词语料库。这个语料库实际上是一个txt的文档，
文档中每个单独的词用两个空格隔开。
根据分词语料库，我们可以求得隐马尔科夫模型中的两个参数矩阵. 根据大数定理，概率等于次数的比值。因此为了模型的准确性，
我们必须有大量的语料数据来计算模型的参数。
</p>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">第四、使用维特比算法进行求解</h2>
<div class="outline-text-2" id="text-4">
<p>
给定马尔科夫模型中的两个参数以及一个观测序列，求解隐藏序列的问题，可以看作是一个类似于图论中的最短路径问题.
</p>

<p>
维特比算法使用动态规划的方法进行求解。动态规划的子问题是，对于第 \(i\) 列的每一个元素 \(A_j\), 
以这个元素为最后一个节点的最短路径。如果知道第 \(i\) 列的每一个元素的最短路径，那么第 \(i+1\) 列的每个元素的最短路径变可求得.
</p>

<p>
最终的结果就是第 \(n\) 列中每一个元素的最短路径中值最小的那一个元素所对应的最短路径。
</p>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">第五、代码实现</h2>
<div class="outline-text-2" id="text-5">
<p>
<a href="https://github.com/astropeak/nlp-word-segmentation">nlp-word-segmentation</a>
</p>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/generative-model-and-descriminative-model/" rel="bookmark">April 23, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/generative-model-and-descriminative-model/">生成模型和判定模型</a></h1>
                </div>
                <div class="entry-content">
                        <p>
统计概率模型的作用是给定输入 \(x\) ， 预测输出 \(y\) 的概率，也即求解条件概率 \(P(y|x)\) 。统计概率模型分为两种：生成模型（Generative Model）和判定模型（Descriminative Model）。
</p>
<ul class="org-ul">
<li>如果模型学习的是 \(P(x, y)\) 的联合概率分布，则这个模型是生成模型。求得 \(P(x, y)\) 后，根据贝叶斯定律，可间接求得 
</li>
</ul>
<p>
\(P(y|x) = \frac{P(x, y)}{P(x)}\) 。
</p>
<ul class="org-ul">
<li>如果模型学习的是 \(P(y|x)\) 的条件概率分布，则这个模型是判定模型。此时是直接求解。
</li>
</ul>
<p>
常见的生成模型和判定模型如下
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">生成模型</th>
<th scope="col" class="left">判定模型</th>
</tr></thead>
<tbody>
<tr>
<td class="left">朴素贝叶斯</td>
<td class="left">罗辑斯谛回归</td>
</tr>
<tr>
<td class="left">隐马尔科夫模型</td>
<td class="left">条件随机场</td>
</tr>
</tbody>
</table>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">为什么叫生成模型</h2>
<div class="outline-text-2" id="text-1">
<p>
  生成模型的中的生成表示: 根据训练数据, 模型学习给定 \(y\) 生成 \(x\) 的概率，即学习 \(P(x|y)\) 。以朴素贝叶斯为例，
求解公式为
</p>
  \begin{equation}
y^* = \underset{y}{\operatorname{argmax}} P(y|x) = \underset{y}{\operatorname{argmax}} P(x|y)P(y)
\end{equation}

<p>
\(P(x|y)\) 表示给定分类 \(y\) ，来预测可能的 \(x\) 值，或者生成 \(x\) 的值。
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">区别</h2>
<div class="outline-text-2" id="text-2">
<p>
判定模型由于是直接学习 \(P(y|x)\) ，因此在相同数目的训练数据条件下，通常其预测效果要好于生成模型。
</p>

<p>
生成模型的功能更加强大。
</p>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/nlp-vocabulary/" rel="bookmark">March 13, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/nlp-vocabulary/">自然语言处理名词表</a></h1>
                </div>
                <div class="entry-content">
                        <table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">名词</th>
<th scope="col" class="left">英文</th>
<th scope="col" class="left">含义</th>
</tr></thead>
<tbody><tr>
<td class="left">词性标注</td>
<td class="left">part of speech, tagging, POS</td>
<td class="left">给定一个句子，为每个词标注词性</td>
</tr></tbody>
<tbody><tr>
<td class="left"> </td>
<td class="left">N－gram</td>
<td class="left">一种文档表示模型，详见 <a href="posts/nlp-vocabulary/bag-of-word-and-ngram-model.html">这里</a>
</td>
</tr></tbody>
<tbody><tr>
<td class="left">词袋</td>
<td class="left">bag of words</td>
<td class="left">一种文档表示模型</td>
</tr></tbody>
<tbody><tr>
<td class="left">停止词</td>
<td class="left">stop word</td>
<td class="left">常用词，如 the， a， of</td>
</tr></tbody>
<tbody><tr>
<td class="left">词根</td>
<td class="left">steming</td>
<td class="left">一个词的词根</td>
</tr></tbody>
<tbody><tr>
<td class="left">命名实体识别</td>
<td class="left">NER</td>
<td class="left">从一个句子中识别人名、地名、机构名等</td>
</tr></tbody>
</table>
</div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/language-model/" rel="bookmark">February 3, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/language-model/">语言模型</a></h1>
                </div>
                <div class="entry-content">
                        <p>
语言模型的定义包含两部分
</p>
<ol class="org-ol">
<li>词汇表 \(V\), 这个语言所有词的集合, 每个词表示为 \(w_i\)
</li>
<li>概率函数 \(P(s)\), 其中 \(s\) 中所有句子组成的集合, 也即为由词汇表 \(V\) 中所有词 \(w_i\) 组成的任意长度的序列.
</li>
</ol>
<p>
语言模型对句子的可能性进行建模。假设语言是由所有可能句子组成的集合,其中句子定义为由任意词语, 以任意顺序, 
以任意长度组成的有序序列。用 \(s\) 表示这样一个句子,则语言模型建模为一个概率分布函数 \(P(s)\), 函数值是这个句子的概率。
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">例子</h2>
<div class="outline-text-2" id="text-1">
<p>
假设一个语言的词汇表只包含三个单词:
</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="n">you</span><span class="p">,</span> <span class="n">are</span><span class="p">,</span> <span class="n">ok</span><span class="p">]</span>
</pre></div>

<p>
由这个词汇表所产生的所有的句子如下所示.
</p>

<p>
长度为一的有3个:
</p>
<div class="highlight"><pre><span></span><span class="n">you</span>
<span class="n">are</span>
<span class="n">OK</span>
</pre></div>

<p>
长度为二的有9个:
</p>
<div class="highlight"><pre><span></span><span class="n">you</span> <span class="n">you</span>
<span class="n">you</span> <span class="n">are</span>
<span class="n">you</span> <span class="n">OK</span>
<span class="n">are</span> <span class="n">you</span>
<span class="n">are</span> <span class="n">are</span>
<span class="n">are</span> <span class="n">OK</span>
<span class="n">OK</span> <span class="n">you</span>
<span class="n">OK</span> <span class="n">are</span>
<span class="n">OK</span> <span class="n">OK</span>
</pre></div>

<p>
长度为三的有27个:
</p>
<div class="highlight"><pre><span></span><span class="n">you</span> <span class="n">you</span> <span class="n">you</span>
<span class="n">you</span> <span class="n">you</span> <span class="n">are</span>
<span class="n">you</span> <span class="n">you</span> <span class="n">OK</span>
<span class="n">you</span> <span class="n">are</span> <span class="n">you</span>
<span class="n">you</span> <span class="n">are</span> <span class="n">are</span>
<span class="n">you</span> <span class="n">are</span> <span class="n">OK</span>
<span class="o">...</span>
<span class="n">are</span> <span class="n">you</span> <span class="n">OK</span>
<span class="o">...</span>
<span class="n">OK</span> <span class="n">OK</span> <span class="n">OK</span>
</pre></div>

<p>
长度为四的，有3×3×3×3个. 长度为五的，有3×3×3×3x3个. 这个序列是无穷的。
</p>

<p>
然后我们有一个概率分布函数 \(P(s)\) 来计算每一个句子 \(s\) 的概率, 以下是这个函数的一些可能结果的例子:
</p>
\begin{equation}
P(are\ you\ OK) = 0.008 \\
P(you\ are\ OK) = 0.002\\
P(you\ you) = 0 \\
P(OK) = 0.01 \\
P(you) = 0\\
\end{equation}
<p>
例子中表示句子 \("are\ you\ OK"\) 的概率为 \(0.008\) , 句子 \("you\ you"\) 的概率为 \(0\). 
</p>

<p>
这样的一个函数 \(P(s)\) 就是这个语言的语言模型.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">语言模型的建立</h2>
<div class="outline-text-2" id="text-2">
<p>
给定一个句子 \(s = w_1w_2w_3...w_n\), 其中 \(w_i\) 是一个词. 语言模型就是要求以下函数
</p>

   \begin{equation}
    P(s)=P(w_1w_2w_3...w_n) \\
  = P(w_1)P(w_2|w_1)P(w_3|w_1w_2)...P(w_n|w_1w_2...w_{n-1})\\
= \prod_i{P(w_i|w_1w_2...w_{i-1})}
   \end{equation}

<p>
其中
</p>
<ul class="org-ul">
<li>\(P(w_1w_2w_3...w_n)\) 为 词序列 \(w_1w_2w_3...w_n\) 的联合概率分布
</li>
<li>\(P(w_1)P(w_2|w_1)P(w_3|w_1w_2)...P(w_n|w_1w_2...w_{n-1})\) 是使用的链式法则后的结果
</li>
</ul>
<p>
这个公式可以理解为一个句子的概率是其所有单词概率的乘积, 一个单词的概率取决于他前面的所有的单词. 如果单词表的数目为5000, 
句子的长度为3，那么有1250亿种可能性, 这个在实际情况下是无法计算的.
</p>

<p>
因此，为了使模型能够实际可计算，需要做出一个假设。语言模型中假设一个词只取决于它前面的一个词，与更之前的所有单词无关,
则上式可以转变为
</p>
\begin{equation}
 P(s)=P(w_1w_2w_3...w_n) = \prod_i{P(w_i|w_{i-1})}
\end{equation}


<p>
这便是语言模型的简化形式: 二元语法模型(bigram model). 相应的也有三元语法模型(trigram model)，
每个词依赖于他前面的两个字。 定义如下:
</p>
\begin{equation}
 P(s)=P(w_1w_2w_3...w_n) = \prod_i{P(w_i|w_{i-1}w_{i-2})}
\end{equation}

<p>
三元语法模型是实际中通常使用的语言模型。
</p>

<p>
通常使用一个语料库来计算每个词的概率。语料库可以由任意文档组成。以二元模型为例，每个词的概率的计算的方法为
</p>
\begin{equation}
 P(w_i|w_{i-1})= \frac{c(w_{i-1}w_i)} {\sum_w{c(w_{i-1}w)}}
\end{equation}

<p>
其中 
</p>
<ul class="org-ul">
<li>\(c(w_{i-1}w_i)\) 为所有以 \(w_{i-1}\) 开头，并且以 \(w_i\) 结束的二元组的数目. 
</li>
<li>\(\sum_w{c(w_{i-1}w)}\) 表示所有以 \(w_{i-1}\) 开头, 并且以任意词结束的二元组的数目. 
</li>
</ul>
<p>
概率就是这两个数目的比值.
</p>
</div>
</div>



<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">参数平滑方法</h2>
<div class="outline-text-2" id="text-3">
<p>
以上计算过程中有一个问题，比如计算以下这个句子的时候，句子的概率将为零。
</p>


<p>
这里的问题是:语料库中不可能包括所有可能出现的词序列, 当某个词的组合在语料库中不存在的时候，便会导致概率为零。
此时需要使用平滑方法来解决这个问题。最简单的一种方法是加法平滑方法.
</p>

<p>
加法平滑方法的基本原理是在统计每一个二元组的数目的时候总是为统计出的数目加个一，如下式所示
</p>
\begin{equation}
 P(w_i|w_{i-1})= \frac{c(w_{i-1}w_i) + 1} {\sum_w{(c(w_{i-1}w) + 1)}} 
\end{equation}


<p>
这样计算后,每个词的概率的计算结果总是大于0. 
</p>

<p>
还有很多种平滑方法，如 <a href="https://en.wikipedia.org/wiki/Good%E2%80%93Turing_frequency_estimation">古德图灵方法</a>，katz平滑方法等。
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">语音识别中应用的例子</h2>
<div class="outline-text-2" id="text-4">
<p>
语音识别中,包含以下两个步骤
</p>
<ol class="org-ol">
<li>根据语音数据, 计算出出几种可能的句子. 因为有同音词的存在, 所以这一步可能有多个结果
</li>
<li>根据语言模型, 计算每个句子的概率，选取概率最大的那个句子作为语音识别的结果
</li>
</ol>
<p>
语言模型在第二步发挥了作用.
</p>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/gradient-descend/" rel="bookmark">February 1, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/gradient-descend/">梯度下降算法</a></h1>
                </div>
                <div class="entry-content">
                        <p>
梯度下降算法是一种用于求解函数最小值的数值计算方法。求解函数的极值一般有两种方法，第一种是解析法, 
即函数的极值可以用公式直接计算出来。如对于1元2次方程，我们可以直接求出这个函数的最大值或者最小值。
但对于更高次的方程或者非线性函数, 大多无法求出解析解，此时需要使用数值方法.
</p>


<p>
对于一元函数来说, 函数的梯度就是其导数. 假设函数为
</p>


\begin{equation}
f(x) = 2x^2-4x+3
\end{equation}

<p>
则函数的梯度函数，也即导数为
</p>

\begin{equation}
Grad(x) = 4x-4
\end{equation}

<p>
梯度下降算法的基本原理如下:
</p>

<p>
对于任意一个自变量 \(x\) 的值 \(x_1\), 我们可以计算此时函数的梯度为 \(Grad(x_1)\), 用当前的 \(x\) 的值 \(x_1\)
减去梯度值的一个比例, 得到一个新的自变量 \(x\) 的值 \(x_2 = x_1 - 0.01*Grad(x_1)\). 则函数在这个新的自变量 \(x\)
的值的地方肯定是小于原来的值的地方, 即
</p>
\begin{equation}
f(x_2) &lt; f(x_1)
\end{equation}
<p>
其中 \(0.01\) 为步长值.
</p>


<p>
比如我们取 \(x_1 = 2\), 此时梯度值为 \(4*2-4=4\), 则 \(x_2 = 2 - 0.01*(4) = 1.96\),
</p>

\begin{equation}
f(x_1) = 2*2^2-4*2+3 = 3\\
f(x_2) = 2*1.96^2-4*1.96+3 = 2.843
\end{equation}

<p>
可见 \(f(x_2) &lt; f(x_1)\)
</p>

<p>
其中
</p>
<ul class="org-ul">
<li>\(x_1=2\) 中的 \(2\) 为自变量的初值. 初值可以随机选择, 如果函数是凸的, 不管初值为何,总能找到相同的极值点
</li>
<li>\(0.01\) 为每次迭代的步长值
</li>
</ul>
<p>
重复以上步骤, 选定初值后,根据以上方法不断变化自变量的值, 随着我们每一次的迭代，自变量的值将慢慢向最优值所对应的 \(x\) 值逼近
(对于这个例子, 最优值对应的 \(x = 1\)). 那么只要迭代的次数足够多，我们总会达到这个最优点，由此便求得函数的最小值.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">梯度的概念</h2>
<div class="outline-text-2" id="text-1">
<p>
以上提到对于一元函数, 其梯度就是函数的导数,梯度值为一个数值。梯度概念是对导数的扩展, 当函数有多于一个自变量的时候.
只是梯度此时是一个向量,向量的每一维分别是对于每一个自变量求偏导数。
</p>

<p>
以一个二元函数为例
</p>
\begin{equation}
f(x_1, x_2) = (x_1-2)^2 + 3x_2
\end{equation}

<p>
函数的梯度函数为
</p>
\begin{equation}
Grad(x_1) = \frac{\partial f}{\partial x_1} = 2x_1-4\\
Grad(x_2) = \frac{\partial f}{\partial x_2}=3\\
Grad(x_1, x_2) = [Grad(x_1), Grad(x_2)] = [2x_1-4, 3]
\end{equation}


<p>
以上讲到的关于自变量沿梯度反方向变化时, 函数值将减小的规则同样适用于二元及更高元的函数. 梯度下降算法的原理也一样,
不同点为此时更新自变量时,是向量操作.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">函数的等值线</h2>
<div class="outline-text-2" id="text-2">
<p>
梯度总是垂直于函数的等值线。从等值线中可以更加形象地看出梯度下降的原理. 当自变量沿着梯度的方向变化时, 
函数值将增加, 等值线所对应的值会增加. 因此，当我们将自变量沿着梯度的反方向变化时，函数的值将会减小. 
由此我们可以求出函数的一个极小值, 通过让自变量不断的向梯度的反方向变化.
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">步长值</h2>
<div class="outline-text-2" id="text-3">
<p>
  梯度给出了自变量变化的方向, 而步长值指定了每次变化的幅度. 如果步长值选得过大，则可能会导致在一次更新自变量后,
错过极值点，从而造成震荡, 无法求得函数的极值. 因此我们要保证步长值足够小，避免震荡现象的出现.
</p>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">收敛准则</h2>
<div class="outline-text-2" id="text-4">
<p>
由于是通过迭代的方式一步一步的改变自变量的值来求函数的极值, 那么怎样判断函数已经达到一个极值了呢? 
此时需要有一个收敛准则, 即判断一次迭代后,函数是否达到极值点. 一般使用的收敛准则为:指定一个精确率, 
当函数值的变化率小于这个精确率时，我们就认为收敛了，此时函数的极值已经被找到.
</p>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">在机器学习算法中的应用</h2>
<div class="outline-text-2" id="text-5">
<p>
对于一个机器学习算法，如果其目标函数可以表示成连续可微的凸函数，则我们可以用梯度下降算法进行求解其最小值或者最大值.
</p>

<p>
例如在对数几率回归算法中, 可以将目标函数写成一个连续可微的凸函数, 然后用梯度下降算法求函数的最小值, 
从而求得模型的参数。
</p>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/bag-of-words-and-ngram-model/" rel="bookmark">January 13, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/bag-of-words-and-ngram-model/">词袋模型和N-gram模型</a></h1>
                </div>
                <div class="entry-content">
                        <p>
词袋模型(bag of words)是常用的语言模型，将文档看作文档中所有词的集合，而忽略词的顺序。尽管丢失了词的顺序这一属性，
但这个模型仍然能够有效用于一些自然处理任务中，如文本分类。
</p>

<p>
N-gram模型是对词袋模型的扩展，N为一个数字，以N＝2为例，2-gram模型将文档看作文档中所有相邻两个词这些词对的集合，
也忽略这些词对在文档中出现的顺序。词袋模型是当N＝1时的特例。
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">例子</h2>
<div class="outline-text-2" id="text-1">
<p>
对于如下文档：
</p>
<pre class="example">
The brown fox jump up the rog.
</pre>

<p>
对应的词袋模型为：
</p>
<pre class="example">
(The, brown, fox, jump, up, the, rog)
</pre>

<p>
对应的2-gram模型为：
</p>
<div class="highlight"><pre><span></span>((The, brown), (brown, fox), (fox, jump), (jump, up), (up, the), (the, rog))
</pre></div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">文档表示</h2>
<div class="outline-text-2" id="text-2">
<p>
将文档表示成词袋模型后,就可以进行定量的分析。一种简单的方式是判断这个文档中是否出现词汇表中某一个词，因此可以将文档表示成一个由0和1组成的向量。
</p>

<p>
如果语言的词汇表如下:
</p>
<pre class="example">
(a, boy, the, cute, likes, dog, little, girl)
</pre>

<p>
则文档与向量表示的对应关系如下.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">文档</th>
<th scope="col" class="left">向量表示</th>
</tr></thead>
<tbody>
<tr>
<td class="left">a little girl</td>
<td class="left">[1, 0, 0, 0, 0, 0, 1, 1]</td>
</tr>
<tr>
<td class="left">the body likes the dog</td>
<td class="left">[0, 1, 1, 0, 1, 1, 0, 0]</td>
</tr>
</tbody>
</table>
<p>
其中向量中的每个元素表示这个文档中是否包含某个词. 如第一向量, 最后一个 1 表示它包含 girl这个词.
</p>

<p>
进一步的可以考虑词语频率(term frequency, TF)的影响，相当于是在前一个表示的模型新增了词语频率这一信息。
词的频率此时可以作为某种度量的权重.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">文档</th>
<th scope="col" class="left">向量表示</th>
</tr></thead>
<tbody>
<tr>
<td class="left">a little girl</td>
<td class="left">[1, 0, 0, 0, 0, 0, 1, 1]</td>
</tr>
<tr>
<td class="left">the body likes the dog</td>
<td class="left">[0, 1, 2, 0, 1, 1, 0, 0]</td>
</tr>
</tbody>
</table>
<p>
第二个向量的第三元素值为2,表示 the 在这个文档中出现了两次.
</p>


<p>
有些词出现的频率非常高，可能在每一篇文档中都会出现，因此引入文档频率(doc frequency, DF)，
也即一个词在所有文档中出现的频率。 如果这个频率很高，那么这个词可能是一个停止词， 需要将其移除，
因为它对文档分类没有帮助。
</p>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">与语言模型的关系</h2>
<div class="outline-text-2" id="text-3">
<p>
词袋模型是语音模型的一种简化形式。语言模型是给定一个词汇表，然后求所有的词的序列的概率。
词袋模型则是将这个词的序列的范围大大缩小，词的序列只包含由单个词所组成的序列，则每个序列的概率则等于词频率。
</p>


<p>
语言模型的详细介绍见<a href="posts/bag-of-words-and-ngram-model/language-model.html">这里</a>.
</p>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">在信息检索中的应用</h2>
<div class="outline-text-2" id="text-4">
<p>
信息检索要解决的问题是:给定一组关键字, 在所有的文档集合中, 返回与关键字相关的所有文档, 并对所有文档根据相关性进行排序.
</p>

<p>
基本的处理方法为: 首先将所有文档表示为词袋模型,表示为一个向量,然后查询搜索关键字是否包含在这个向量里,
这样便可以计算出所有与给定关键字相关的文档. 排序文档时,可能根据词频-逆文档频率(TF-IDF)进行排序.
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">在文本分类的应用</h2>
<div class="outline-text-2" id="text-5">
<p>
使用词袋模型的向量表示将每个文档表示为数学的形式,然后再输入到具体机器学习算法中.
</p>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/recall-precision-fscore/" rel="bookmark">January 7, 2017</a>
                        </span>
                    </div>
                    <h1><a href="posts/recall-precision-fscore/">Recall，Precision 和 F-score</a></h1>
                </div>
                <div class="entry-content">
                        <p>
这个三个数据用于描述一个模型的好坏程度，分别为召回率、准确度和F值。
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">定义</h2>
<div class="outline-text-2" id="text-1">
<p>
在二分类模型中，对于任意一个输入数据，结果只用两个：正类或者负类。对于一个输入数据集，假定该模型产生如下结果：
</p>

<ul class="org-ul">
<li>PT： 模型结果为正类且真实为正类的数目
</li>
<li>PF： 模型结果为正类且真实为负类的数目
</li>
<li>NT： 模型结果为负类且真实为负类的数目
</li>
<li>NF： 模型结果为负类且真实为正类的数目
</li>
</ul>
<p>
则召回率、准确度和F值的定义分别为：
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
</colgroup>
<tbody>
<tr>
<td class="left">Recall</td>
<td class="left">\(\frac{PT}{PT + NF}\)</td>
</tr>
<tr>
<td class="left">Precision</td>
<td class="left">\(\frac{PT}{PT + PF}\)</td>
</tr>
<tr>
<td class="left">F-score</td>
<td class="left">\(\frac{Recall + Precision}{2}\)</td>
</tr>
</tbody>
</table>
<p>
召回率和准确度具有相同的分子，分母不同。F值是二者的算数平均数。
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">搜索引擎的例子</h2>
<div class="outline-text-2" id="text-2">
<p>
假设给定一个关键字， 搜索引擎返回了100个文档，其中80个是正确的，也即符合关键字，
剩余20个是错误的，也即和给定的关键字没有关系。则此时准确度为： \(80/100 = 80\%\)
</p>

<p>
假设还有40篇文档也符合这个关键字，但搜索引擎并没有返回这40篇文档，则召回率为： \(80 / (80 + 40) = 67\%\)
</p>

<p>
由此可见， 召回率表示了搜索引擎从所有符合条件的文档中“召回”正确文档的比例， 而准确度表示了搜索引擎返回文档中正确文档的比例。
所有符合条件的文档和返回文档这两个概念是不同的。
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">进一步思考</h2>
<div class="outline-text-2" id="text-3">
<p>
召回率描述了是否有遗漏，准确度描述了是否正确，F值综合了二者。
</p>

<p>
  如果一个模型如果准确率很高，但召回率很低，即使结果中大多数数据是正确的，但却遗漏了很多正确的数据。如果一个模型召回率很高，
但准确率很低，则表示这个模型可能返回所有正确的数据，但返回的数据中，错误的数据也很多。
</p>

<p>
好的模型应该做到召回率和准确率都较高，也即F值较高。
</p>
</div>
</div>
                </div>
            </article>
</div>
        <div class="site-content">
            <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
                    <div class="entry-meta">
                        <span class="posted-on">
                            Posted on <a href="posts/emacs-lisp/" rel="bookmark">September 24, 2015</a>
                        </span>
                    </div>
                    <h1><a href="posts/emacs-lisp/">Emacs Lisp 编程笔记</a></h1>
                </div>
                <div class="entry-content">
                        <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/emacs-lisp/#sec-1">错误处理</a>
<ul>
<li><a href="posts/emacs-lisp/#sec-1-1">抛出错误</a></li>
<li><a href="posts/emacs-lisp/#sec-1-2">捕获错误</a></li>
<li><a href="posts/emacs-lisp/#sec-1-3">忽略错误</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">错误处理</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">抛出错误</h3>
<div class="outline-text-3" id="text-1-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">signal</span> <span class="ss">'my-error</span> <span class="o">'</span><span class="p">(</span><span class="s">"This is a demo error"</span><span class="p">))</span>
<span class="p">(</span><span class="nf">error</span> <span class="s">"This is another error"</span><span class="p">)</span>
</pre></div>
<p>
What's the difference between the two?
</p>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">捕获错误</h3>
<div class="outline-text-3" id="text-1-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">progn</span>
  <span class="p">(</span><span class="nf">condition-case</span> <span class="nv">err</span>
      <span class="p">(</span><span class="nf">signal</span> <span class="ss">'my-error</span> <span class="o">'</span><span class="p">(</span><span class="s">"This is a demo error"</span><span class="p">))</span>
    <span class="p">(</span><span class="ss">'my-error</span> <span class="p">(</span><span class="nf">message</span> <span class="s">"my error handled, %s"</span> <span class="nv">err</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">message</span> <span class="s">"end"</span><span class="p">))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">aaa</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">condition-case</span> <span class="nv">error</span>
      <span class="p">(</span><span class="nf">progn</span>
	<span class="p">(</span><span class="nf">op/git-change-branch</span> <span class="nv">op/repository-directory</span> <span class="s">"source"</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">op/git-commit-changes</span> <span class="nv">op/repository-directory</span> <span class="s">"Changes"</span><span class="p">))</span>
    <span class="o">'</span><span class="p">(</span><span class="ss">'git-error</span>  <span class="p">(</span><span class="nf">message</span> <span class="s">"Error is %s"</span> <span class="nv">error</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">aaa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">忽略错误</h3>
<div class="outline-text-3" id="text-1-3">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">progn</span>
  <span class="p">(</span><span class="nf">ignore-errors</span>
    <span class="c1">;;(signal 'my-error '("This is a demo error"))</span>
    <span class="p">(</span><span class="nf">error</span> <span class="s">"This is another error"</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nf">message</span> <span class="s">"end"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
                </div>
            </article>
</div>
    <!-- Lower Navigation links -->
    <nav class="site-content navigation-post" role="navigation"><div class="previous">
                <a href="." rel="prev" onclick="return false;">
                    <span class="meta-nav">No More Older Entries</span>                </a>
            </div>
            <div class="next">
                <a href="." rel="next">
                    <span class="meta-nav">Newer Entries</span>                </a>
            </div>
    </nav><!-- Page Footer --><section class="footer-sidebar clear" role="complementary"><div class="widget-block">
            <aside class="widget"><h2 class="widget-title">Astropeak</h2>
                <div class="widget-text">Astropeak's blogs.</div>
            </aside>
</div>
    </section><!-- Site Attributions --><footer class="site-footer" role="contentinfo"><div class="site-info">
            <p>Contents © 2018         <a href="mailto:astropeak@gmail.com">Astropeak</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
        </div>
        <div class="social">
            <ul class="menu"></ul>
</div>
    </footer>
</body>
</html>
